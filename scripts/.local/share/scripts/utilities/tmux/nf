#!/usr/bin/env bash

selected="${1:-}"
if [[ -z "$selected" ]]; then
    # the -not -path is to ignore hidden folders 
    selected=$(find -L $WORK $PROJECTS $PLAYGROUND/code $LEARN -mindepth 1 -maxdepth 1 -not -path '*/\.*' -type d | fzf --preview="ls {} --color=always" --delimiter / --with-nth -2,-1 --preview-window=60%:wrap)
fi

[[ -z $selected ]] && exit 0

declare -A types=(["work"]="$WORK" ["project"]="$PROJECTS" ["code"]="$PLAYGROUND/code"  ["learn"]="$LEARN")
selected_name=$(basename "$selected" | tr . _)
for key in "${!types[@]}"; do
    if grep -o "/$key/" <<< "$selected"; then
        prefix="${key:0:1}"
    fi
    prefix=${key:0:1}
done


tmux-sessionizer "$selected" "$prefix-$selected_name" 
